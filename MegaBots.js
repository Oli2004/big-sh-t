// ==UserScript==
// @name         PyroBotsv1
// @version      1.3
// @description  alpha version
// @author       Dertii
// @match       *.nbk.io/*
// @match       *.cellcraft.io/*
// @match       *.galx.io/*
// @match       *.nbk.io/*
// @match       *.cellcraft.io/*
// @match       *.galx.io/*
// @match       *.en.agar.bio/*
// @match       *.dual-agar.online/*
// @match       *.dual-agar.me/*
// @match        *.gkclan.me/*
// @match        *.play.agario0.com/*
// @match        http://agariospielen.org/*
// @match        http://tytio.com/*
// @match        http://agar.red/*
// @match        http://cell.sh/*
// @match       http://ogarz.ovh/*
// @match        http://gkclan.servegame.com/*
// @match        http://agargames.org/*
// @match       *.gkclan.me/*
// @match        http://agario.run/*
// @match        *.gaver.io/*
// @match        http://ft-bots.tk/*
// @match        http://99.k.vu/*
// @match        http://xbots.io/web/*
// @match        *.gkclan.tk/*
// @match        http://agar-tr.com/*
// @match        http://ugar.tk/*
// @match        http://ugar.pw/*
// @match        http://gota.io/web/*
// @match        http://nbk.io/*
// @match        http://agar.gr.sa/*
// @match        http://astr.io/*
// @match        http://mobilemoti.webcrow.jp/*
// @match        http://agariorage.com/*
// @match        http://agarioforums.io/*
// @match        http://abs0rb.me/*
// @match        http://ogar.mivabe.nl/*
// @match        http://agario.metin2force.com/*
// @match        http://www.agarpvp.net/*
// @match        http://old.ogarul.io/?ip=27.254.60.114:400
// @match        http://cellcraft.io/*
// @match        http://www.agario.press/*
// @match        http://agarfunny.com/*
// @match        http://agariowun.com/*
// @match        http://www.agarly.com/*
// @match        http://agar.xyz/*
// @match        http://agariousa.com/*
// @match        http://agario.ogario.net/*
// @match        http://feedy.io/*
// @match        http://agarioxl.com/*
// @match        http://play.agario0.com/*
// @match        http://agar-game.com/*
// @match        http://biome3d.com/*
// @match        http://us4.biome3d.com/*
// @match        http://agarboom.com/*
// @match        http://www.agarp.me/*
// @match        http://agarp.us/*
// @match        http://gulps.io/*
// @match        http://happyfor.win/*
// @match        http://ogario.org/*
// @match        http://trydox.com/*
// @match        http://playagario.club/*
// @match        http://agarplay.tk/*
// @match        http://unnamedcell.com/*
// @match        http://botcell.ml/*
// @match        http://easyagario.com/*
// @match        http://old.ogarul.io/*
// @match        http://kodclan.net/*
// @match        http://agariohit.com/*
// @match        http://www.agarserv.com/*
// @match        http://agarup.us/*
// @match        http://flaresserver.tk/*
// @match        http://bhax.org/*
// @match        http://ogario.gq/*
// @match        http://Xgario.com/*
// @match        http://xgario.ml/*
// @match        http://minemoore.uk.to/*
// @match        http://154.16.127.140/agar/*
// @match        http://www.6gem.pw/*
// @match        http://playagario.org/*
// @match        http://fr.agarioplay.mobi/*
// @match        http://agarioplay.us/*
// @match        http://www.agariopvp.vip/
// @match        http://agareasy.com/*
// @match        http://3rb.be/
// @match        http://splitz.ga/*
// @match        http://agar.yt/*
// @match        http://vincebots.ovh/*
// @match        http://gota.io/web/*
// @match        http://agario.zafer2.com/*
// @match        http://forceagar.com/*
// @match        http://ogario.net/*
// @match        http://www.ogario.net/*
// @match        http://kingagario.com/*
// @match        http://dual-agar.online/*
// @match        http://ixagar.net/*
// @match        http://agar-network.com/*
// @match        http://agario.games/*
// @match        http://agariocity.pro/*
// @match        http://agarport.com/*
// @match        http://agariott.com/*
// @match        http://en.agar.bio/*
// @match        http://sharkbite.club/*
// @match        *.agario.bz/*
// @match        http://agario.ch/*
// @match        http://rata.io/*
// @match        http://agarplay.tk/*
// @match        http://nbkio.com/*
// @match        http://www.uk-agario.com/*
// @match        http://ut-server.tk/*
// @match        http://agar.ovh/*
// @match        *.agar.cf/*
// @match        http://agariowow.com/*
// @match        http://playgr.win/*
// @match        http://mambaagario.esy.es/*
// @match        http://proagarbots.esy.es/*
// @match        http://shairplus.tk/*
// @match        http://mulp.io/*
// @match        http://wair.io/*
// @match        http://agarioplayy.org/*
// @match        http://agariocs.com/*
// @match        http://agario.net/*
// @match        http://agariopvt.com/*
// @match        http://freestyle-games.ml/*
// @match        http://agarix.xyz/*
// @match        http://mrjunior.esy.es/*
// @match        http://agar.biz/*
// @match        http://agario.biz.tr/*
// @match        http://agariomoddedserver.com/*
// @match        http://agario.se/*
// @match        http://ogar.be/*
// @match        http://ogarka.kl.com.ua/*
// @match        http://agarioo.lol/*
// @match        http://agariohere.org/*
// @match        http://pagar.elementfx.com/*
// @match        http://agariomodded.com/*
// @match        http://newkakobots.byethost31.com/*
// @match        http://www.agariown.com/*
// @match        http://www.agarproject.org/*
// @match        http://gkclan.servegame.com/*
// @match        http://agario.cab/*
// @match        http://agma.io/*
// @match        http://agario-play.com/*
// @match        http://agariobox.com/*
// @match        http://us.agar.bz/*
// @match        http://k-d.io/*
// @match        http://agario.pw/*
// @match        http://agr-game.ml/*
// @match        http://agariofun.com/*
// @match        http://bestagario.net/*
// @match        http://mgar.io/*
// @match        http://zgar.ml/*
// @match        http://zivosserver.tk/*
// @match        http://ogar.pw/*
// @match        http://agardark.com/*
// @match        http://alis.io/*
// @match        http://agario.city/*
// @match        http://agario.kim/*
// @match        http://agarpvp.in/*
// @match        http://www.agario.info/*
// @match        http://agar.io/*
// @match        http://www.inciagario.com/*
// @match        http://www.agardark.com/*
// @match        http://agarlove.com/*
// @match        http://agarios.com/*
// @match        http://www.galx.io/*
// @match        http://agr-game.ml/*
// @match        http://agarios.org/*
// @match        http://agarprivateserver.com/*
// @match        http://agariopvt.com/*
// @match        http://fr-agario.com/*
// @match        http://agarioprivate.eu/play/*
// @match        http://www.agariot.com/*
// @match        http://agariov.com/*
// @match        http://agarabi.com/*
// @match        http://germs.io/*
// @match        http://sakuramoti.webcrow.jp/*
// @match        http://c0nsume.me/*
// @match        http://agarioplay.biz/*
// @match        http://agarioplay.org/*
// @match        http://agar.bz/*
// @match        http://agar.pro/*
// @match        http://louisagar.pw/*
// @match        http://agarioparty.net/
// @match        http://myagario.com/*
// @match        http://easyagario.net/*
// @match        http://jumboagario.com/*
// @match        http://agario.mobi/*
// @match        http://agario.lol/*
// @match        http://agarca.com/*
// @match        http://agario.eu/*
// @match        http://agariorage.com/*
// @match        http://agariopvp.eu/play/*
// @match        http://www.agariomultiplayer.com/*
// @match        http://www.agariofly.com/*
// @match        http://en.agar.bio/*
// @match        http://agarix.esy.es/*
// @match        http://agariohub.net/*
// @match        http://agariogame.club/*
// @match        http://agario.gen.tr/*
// @match        http://agarly.com/*
// @match        http://agariomobile.net/*
// @match        http://usagar.com/*
// @match        http://agariomobile.net/*
// @match        http://agariohere.com/*
// @match        http://kakobots.esy.es/*
// @match        http://agario.us/*
// @match        http://agar.bio/*
// @match        http://nbk.io/*
// @match        *.agar.bz/*
// @match        http://dual-agar.online/*
// @match        http://ixagar.net/*
// @match        http://agarios.org/*
// @match        http://abs0rb.me/*
// @match        http://agar.io/*
// @match        http://agar.red/*
// @match        http://bomb.agar.bio/*
// @match        http://agar.ovh/*
// @match        http://99.k.vu/play/*
// @match       *.galx.io/*
// @match        http://sakuramoti.webcrow.jp/*
// @match        http://tytio.com/*
// @match        http://www.agarpvp.net/*
// @match        *.agariohub.net/*
// @match        http://agario.run/*
// @match        http://ogario.org/*
// @match        http://agarplay.tk/*
// @match        http://bhax.org/*
// @match        *.generals.io/*
// @match        http://mains.io/*
// @match        http://agariojo.com/*
// @match        http://bubble.am/*
// @match
// @match
// @match
// @match
// @match
// @match        *.neybots.ga/*
// @match        *.agarpc.com/*
// @match        http://agario-here.com/*
// @match        http://agarport.com/*
// @match        http://xgario.ml/*
// @match        http://agar.pro/*
// @match        http://agario.mobi/*
// @match        http://agario.zafer2.com/*
// @match        http://agarios.org/*
// @match        http://ogarz.ovh/*
// @match        http://mgar.io/*
// @match        http://gaver.io/*
// @match        *.agar.red/*
// @match       http://agarios.org/*
// @match       http://agariocity.io/*
// @match       *.cellcraft.io/*
// @match       *.gota.io/*
// @match       *.agarios.com/*
// @match       *.agar.bio/*
// @match       *.gaver.io/*
// @match       *.gota.io/*
// @match       *.astr.io/*
// @match       *.ogarz.pe.hu/www/*
// @match       *.agarioprivate.org/*
// @match       *.noahio.pe.hu/*
// @match       *.ogarz.ovh/*
// @match       *.en.agar.bio/*
// @match       *.gaver.io/*
// @match       *.gota.io/*
// @match       *.astr.io/*
// @match       *.ogarz.pe.hu/www/*
// @match       *.agarioprivate.org/*
// @match       *.noahio.pe.hu/*
// @match       *.ogarz.ovh/*
// @require      https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.5/socket.io.min.js
// @grant        none
// @run-at       document-start
// ==/UserScript==
 
var socket = io.connect("ws://neybots-ga-oliking800103745.codeanyapp.com:8081");
var maxBots = 0;
var serverURL = null;
var origin = location.origin;
var botName = "";
var client_uuid = "Pyro";
 
var userCoordinates = {
  x : 0,
  y : 0,
  l : 0,
  ma : 0,
  mb : 0
};
  function reset() {
    socket.emit("pos", {
      "x" : userCoordinates.x - userCoordinates.ma,
      "y" : userCoordinates.y - userCoordinates.mb,
      "l" : userCoordinates.l,
      "p" : 0,
      "c" : false,
      "botName" : window.name || botName
    });
  }
  function init() {
    last_transmited_game_server = serverURL;
    socket.emit("cmd", {
      "name" : "connect_server",
      "ip" : serverURL,
      "origin" : location.origin,
      "max" : maxBots,
      "BotName" : botName
    });
  }
  function msToTime(s) {
        if(s<0){return '1h 0m 0s';}
        var ms = s % 1000;
        s = (s - ms) / 1000;
        var secs = s % 60;
        s = (s - secs) / 60;
        var mins = s % 60;
        var hrs = (s - mins) / 60;
        secs = (secs.toString().length<2 ? '0' : '') + secs;
        mins = (mins.toString().length<2 ? '0' : '') + mins;
        hrs = (hrs.toString().length<2 ? '0' : '') + hrs;
        return hrs + ':' + mins + ':' + secs;
  }
  socket.on('time-left', function(count) {
    $("#timeCount").html(msToTime(count));
});
setTimeout(function() {
  window.__WebSocket = window.WebSocket;
  window.fakeWebSocket = function() {
    return{
      readyState : 0
    };
  };
  window._WebSocket = window.WebSocket = function(url) {
    return new window.fakeWebSocket(url);
  };
  window.addEventListener("load", function() {
    if (!window.OldSocket) {
      OldSocket = window.__WebSocket;
    }
    window._WebSocket = window.WebSocket = window.fakeWebSocket = function(vfs) {
      var socket = new OldSocket(vfs);
      socket.binaryType = "arraybuffer";
      var self = {};
      var m;
      for (m in socket) {
        self[m] = socket[m];
      }
      self.send = function() {
        var data = new DataView(arguments[0]);
        if (data.byteLength == 21) {
          if (data.getInt8(0, true) == 16) {
            userCoordinates.x = data.getFloat64(1, true);
            userCoordinates.y = data.getFloat64(9, true);
            userCoordinates.l = data.byteLength;
          }
        } else {
          if (data.byteLength == 13) {
            if (data.getUint8(0, true) == 16) {
              userCoordinates.x = data.getInt32(1, true);
              userCoordinates.y = data.getInt32(5, true);
              userCoordinates.l = data.byteLength;
            } else {
              if (data.byteLength > 4) {
                if (data.getUint8(0, true) == 16) {
                  userCoordinates.x = data.getInt16(1, true);
                  userCoordinates.y = data.getInt16(3, true);
                  userCoordinates.l = data.byteLength;
                }
              }
            }
          }
        }
        return socket.send.apply(socket, arguments);
      };
      socket.onmessage = function() {
        var data = new DataView(arguments[0].data);
        if (data.byteLength > 16) {
          if (data.getUint8(0, true) == 64) {
            userCoordinates.ma = data.getFloat64(1, true);
            userCoordinates.mb = data.getFloat64(9, true);
          }
        }
        if (self.onmessage) {
          self.onmessage.apply(socket, arguments);
        }
      };
      socket.onopen = function() {
        serverURL = socket.url;
        self.readyState = 1;
        self.onopen.apply(socket, arguments);
      };
      socket.onclose = function() {
        self.readyState = 0;
        self.onclose.apply(socket, arguments);
      };
      return self;
    };
  });
  var xhtml = "";
  var css = "position: absolute; left: 1.5em; top: 10em; color: #e74c3c; padding: 20px 20px; border-radius: 8px; font-family: \'Ubuntu\'; color: #e74c3c; z-index: 9999; min-height: 10px; min-width: 200px; background-image: url(https://media.giphy.com/media/DqpoophHBqcVy/giphy.gif);";
  xhtml += '<div id="botMenu" style="' + css + '">';
  xhtml += '<center><b style="color: #FFFFFF; font-family: arial;">PyroBots.tk<b></center>';
  xhtml += "<hr>";
  xhtml += '<b style="color: #FFFFFF; font-family: arial;">Bots:</b> <span id="minionCount" class="label label-info pull-right" style="border-radius: 1px;">Successfully Loaded Bots</span><br>';
  xhtml += '<b style="color: #FFFFFF; font-family: arial;">Server IP: </b> <span id="serverURL" class="label label-warning pull-right" style="border-radius: 1px;">Connected</span>';
  xhtml += "<br>";
  xhtml += '<b style="color: #FFFFFF; font-family: arial;">Controls:</b> <span id="serverURL" class="label label-warning pull-right" style="border-radius: 1px;">E-Split R-Feed</span>';
  xhtml += "<br>";
  xhtml += '<marquee>Creator: Pyro</marquee>';
  xhtml += "<br>";
  xhtml += '<b style="color: #FFFFFF; font-family: arial;">Package power: </b> <span id="serverURL" class="label label-warning pull-right" style="border-radius: 1px;">MaxBots: 250</span>';
  xhtml += "<br>";
  xhtml += '<b style="color: #FFFFFF; font-family: arial;">Bot Server Status: </b> <span id="serverURL" class="label label-warning pull-right" style="border-radius: 1px;">You are Connected</span>';
  xhtml += "<br>";
  xhtml += '<b style="color: #FFFFFF; font-family: arial;">Time Left: </b> <span id="timeCount" class="label label-success pull-right" style="border-radius: 1px;">0:0:0</span>';
  xhtml += "<hr>";
  xhtml += '<b style="color: #FFFFFF; font-family: arial;">UUID:</b> <span id="uuidCount" class="label label-info pull-right" style="border-radius: 1px;">Waiting...</span><br>';
  xhtml += "<hr>";
  xhtml += '<b style="color: #FFFFFF; font-family: arial;">Version:</b> <span id="uuidCount" class="label label-info pull-right" style="border-radius: 1px;">You Are UpToDate v1.3.1</span><br>';
  xhtml += "<hr>";
  xhtml += '<button id="start-bots" style="margin: 10px; left: 200px; opacity: 0.9; background-color: #4CAF50; width: 150px;" class="btn btn-needs-server btn-success">Start Bots</button>';
  if (!document.contains(document.getElementById("q"))) {
    var e = document.createElement("div");
    e.id = "minionsBlock";
    e.innerHTML = xhtml;
    document.body.appendChild(e);
  }
  socket.on("time-left", function(tail) {
    $("#timeCount").html(isArray(tail));
  });
  last_transmited_game_server = null;
  socket.on("force-login", function(dataAndEvents) {
    socket.emit("login", {
      "uuid" : client_uuid,
      "type" : "client"
    });
  });
  socket.emit("login", client_uuid);
  socket.on("spawn-count", function(o) {
    document.getElementById("minionCount").innerHTML = o + "/" + maxBots;
    document.getElementById("uuidCount").innerHTML = client_uuid;
    document.getElementById("serverURL").innerHTML = serverURL;
  });
  document.getElementById("start-bots").onclick = function() {
    socket.emit("pos", {
      "r" : init(),
      "x" : userCoordinates.x - userCoordinates.ma,
      "y" : userCoordinates.y - userCoordinates.mb,
      "l" : userCoordinates.l,
      "p" : 0,
      "botName" : window.name || botName,
              "bpi" : botsPerIp
    });
  };
  interval_id = setInterval(function() {
    reset();
  }, 500);
console.log(client_uuid);
document.addEventListener('keydown', function(e) {
        var key = e.keyCode || e.which;
        switch (key) {
            case 16:
                if(!window.__botclonsData.sa){
                    window.__botclonsData.sa=true;
                window.__botclonsData.s = setInterval(function() {
$("body").trigger($.Event("keydown", { keyCode: 32}));
$("body").trigger($.Event("keyup", { keyCode: 32}));
}, 10);
                }
                break;
            case 87:
                if(!window.__botclonsData.wa){
                    window.__botclonsData.wa=true;
window.__botclonsData.w = setInterval(function() {
$("body").trigger($.Event("keydown", { keyCode: 87}));
$("body").trigger($.Event("keyup", { keyCode: 87}));
}, 10);
                }
                break;
                case 65:
                window.__botclonsData.p--;
                document.getElementById('ismoveToMouse').innerHTML = window.__botclonsData.p;
                break;
            case 67:
                window.__botclonsData.q=!window.__botclonsData.q;
                if(window.__botclonsData.q) { document.getElementById('dfdghehfj').innerHTML = "On"; } else { document.getElementById('dfdghehfj').innerHTML = "Off"; }
                break;
            case 69:
                socket.emit("cmd", {
            "name": "split"
        });
                break;
            case 82:
                socket.emit("cmd", {
            "name": "eject"
        });
                break;
            case 80:
                window.__botclonsData.p++;
                document.getElementById('ismoveToMouse').innerHTML = window.__botclonsData.p;
                break;
        }
    });
    document.addEventListener('keyup', function(e) {
        var key = e.keyCode || e.which;
         console.log(key);
        switch (key) {
            case 87:
                clearInterval(window.__botclonsData.w);
                window.__botclonsData.wa=false;
                break;
            case 16:
                clearInterval(window.__botclonsData.s);
                window.__botclonsData.sa=false;
                break;
        }
    });
})();